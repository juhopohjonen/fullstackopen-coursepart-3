{"ast":null,"code":"import _toConsumableArray from\"/home/juho/Documents/fullstackopen/course-part-03/puhelinfrontti/puhelinluettelo/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/juho/Documents/fullstackopen/course-part-03/puhelinfrontti/puhelinluettelo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from'react';import personService from'./services/persons';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Contact=function Contact(_ref){var person=_ref.person,removeFunction=_ref.removeFunction;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"p\",{children:[person.name,\" \",person.number,\" \",/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return removeFunction(person.id);},children:\"delete\"})]})});};var Filter=function Filter(_ref2){var inputValue=_ref2.inputValue,onInputChange=_ref2.onInputChange;return/*#__PURE__*/_jsxs(\"div\",{children:[\"filter shown with \",/*#__PURE__*/_jsx(\"input\",{value:inputValue,onChange:onInputChange})]});};var SuccessNotification=function SuccessNotification(_ref3){var message=_ref3.message;if(message===null){return null;}return/*#__PURE__*/_jsx(\"div\",{className:\"success\",children:message});};var ErrorNotification=function ErrorNotification(_ref4){var message=_ref4.message;if(message==null){return null;}return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:message});};var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),successMsg=_useState4[0],setSuccessMsg=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),errorMsg=_useState6[0],setErrorMsg=_useState6[1];var getPersons=function getPersons(){personService.getAllPersons().then(function(response){setPersons(response.data);});};useEffect(getPersons,[]);var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),newName=_useState8[0],setNewName=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),newNumber=_useState10[0],setNewNumber=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),filter=_useState12[0],setFilter=_useState12[1];var handleInputChange=function handleInputChange(event){setNewName(event.target.value);};var handleNumberChenge=function handleNumberChenge(event){setNewNumber(event.target.value);};var filterBy=function filterBy(event){setFilter(event.target.value);};var createPersonObject=function createPersonObject(){var personObject={name:newName,number:newNumber};return personObject;};var personsToShow=filter===''?persons:persons.filter(function(person){return person.name.toLowerCase().includes(filter.toLowerCase());});var addNewPerson=function addNewPerson(event){event.preventDefault();var personExistsAlready=doesPersonExist();if(personExistsAlready!==false){//alert(`${newName} is already added to phonebook`)\nvar confirmation=window.confirm(\"\".concat(newName,\" is already added to phonebook, replace the old number with a new one?\"));if(!confirmation){return;}var newPerson=createPersonObject();handlePut(newPerson,personExistsAlready.id);}else{var personObject=createPersonObject();personService.newPerson(personObject).then(function(response){setPersons(persons.concat(response.data));setSuccessMsg(\"Added \".concat(response.data.name));setTimeout(function(){setSuccessMsg(null);},5000);});}};var handleRemove=function handleRemove(postId){var confirm=window.confirm('Are you sure you want to remove this contact?');if(!confirm){return;}var personName=_toConsumableArray(persons).filter(function(person){return person.id===postId;})[0].name;personService.removePerson(postId).then(setPersons(persons.filter(function(person){return person.id!==postId;}))).catch(function(error){setErrorMsg(\"Information of '\".concat(personName,\"' has already beed removed from server\"));setTimeout(function(){setErrorMsg(null);},5000);});};var handlePut=function handlePut(person,id){console.log('called handleput func');personService.putPerson(person,id).then(function(response){var filteredPersons=persons.filter(function(person){return person.id!==id;});var newPerson=response.data;filteredPersons.push(newPerson);setPersons(filteredPersons);});};var doesPersonExist=function doesPersonExist(){var fakeNewPerson=createPersonObject();var currentPersons=_toConsumableArray(persons).filter(function(person){return person.name===fakeNewPerson.name;});if(currentPersons.length>0){return currentPersons[0];}return false;};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(SuccessNotification,{message:successMsg}),/*#__PURE__*/_jsx(ErrorNotification,{message:errorMsg}),/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),/*#__PURE__*/_jsx(Filter,{inputValue:filter,onInputChange:filterBy}),/*#__PURE__*/_jsx(\"h2\",{children:\"add a new\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:addNewPerson,children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"name: \",/*#__PURE__*/_jsx(\"input\",{value:newName,onChange:handleInputChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"number: \",/*#__PURE__*/_jsx(\"input\",{value:newNumber,onChange:handleNumberChenge})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"add\"})})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Numbers\"}),personsToShow.map(function(person){return/*#__PURE__*/_jsx(Contact,{removeFunction:handleRemove,person:person},person.name);})]});};export default App;","map":{"version":3,"names":["useEffect","useState","personService","Contact","person","removeFunction","name","number","id","Filter","inputValue","onInputChange","SuccessNotification","message","ErrorNotification","App","persons","setPersons","successMsg","setSuccessMsg","errorMsg","setErrorMsg","getPersons","getAllPersons","then","response","data","newName","setNewName","newNumber","setNewNumber","filter","setFilter","handleInputChange","event","target","value","handleNumberChenge","filterBy","createPersonObject","personObject","personsToShow","toLowerCase","includes","addNewPerson","preventDefault","personExistsAlready","doesPersonExist","confirmation","window","confirm","newPerson","handlePut","concat","setTimeout","handleRemove","postId","personName","removePerson","catch","error","console","log","putPerson","filteredPersons","push","fakeNewPerson","currentPersons","length","map"],"sources":["/home/juho/Documents/fullstackopen/course-part-03/puhelinfrontti/puhelinluettelo/src/App.js"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport personService from './services/persons'\n \nconst Contact = ({ person, removeFunction }) => (\n  <div>\n    <p>{person.name} {person.number} <button onClick={() => removeFunction(person.id)}>delete</button></p>\n  </div>\n)\n\nconst Filter = ({ inputValue, onInputChange }) => (\n  <div>\n  filter shown with <input value={inputValue} onChange={onInputChange} />\n</div>\n)\n\n\nconst SuccessNotification = ({ message }) => {\n  if (message === null) {\n    return null\n  }\n\n  return (\n    <div className='success'>\n      {message}\n    </div>\n  )\n\n}\n\nconst ErrorNotification = ({ message }) => {\n  if (message == null) {\n    return null\n  }\n\n  return (\n    <div className='error'>\n      {message}\n    </div>\n  )\n}\n\n\nconst App = () => {\n\n  const [persons, setPersons] = useState([])\n\n  const [successMsg, setSuccessMsg] = useState(null)\n  const [errorMsg, setErrorMsg] = useState(null)\n \n  const getPersons = () => {\n    personService.getAllPersons()\n      .then(response => {\n        setPersons(response.data)\n      })\n  }\n\n  useEffect(getPersons, [])\n\n  const [newName, setNewName] = useState('')\n  const [newNumber, setNewNumber] = useState('')\n  const [filter, setFilter] = useState('')\n\n  const handleInputChange = (event) => {\n    setNewName(event.target.value);\n  }\n\n  const handleNumberChenge = (event) => {\n    setNewNumber(event.target.value);\n  }\n\n  const filterBy = (event) => {\n    setFilter(event.target.value);\n  }\n\n  const createPersonObject = () => {\n    const personObject = {\n      name: newName,\n      number: newNumber\n    }\n\n    return personObject\n  }\n\n  const personsToShow = filter === '' \n  ? persons\n  : persons.filter(person => person.name.toLowerCase().includes(filter.toLowerCase()))\n\n  const addNewPerson = (event) => {\n    event.preventDefault();\n\n    const personExistsAlready = doesPersonExist()\n\n    if (personExistsAlready !== false) {\n      \n      //alert(`${newName} is already added to phonebook`)\n\n      const confirmation = window.confirm(\n        `${newName} is already added to phonebook, replace the old number with a new one?`\n      )\n\n      if (!confirmation) {\n        return\n      }\n\n      const newPerson = createPersonObject();\n      handlePut(newPerson, personExistsAlready.id)\n\n \n\n    } else {\n      const personObject = createPersonObject();\n  \n      personService.newPerson(personObject)\n      .then(response => {\n        setPersons(persons.concat(response.data))\n        setSuccessMsg(\n          `Added ${response.data.name}`\n        )\n\n        setTimeout(() => {\n          setSuccessMsg(null)\n        }, 5000);\n      })\n    } \n    \n\n  }\n\n  const handleRemove = postId => {\n    const confirm = window.confirm('Are you sure you want to remove this contact?')\n\n    if (!confirm) {\n      return\n    }\n\n    const personName = [...persons].filter(person => person.id === postId)[0].name\n    \n    personService.removePerson(postId)\n    .then(\n      setPersons(\n        persons.filter(person => person.id !== postId)\n      )\n    )\n    .catch(error => {\n      setErrorMsg(\n        `Information of '${personName}' has already beed removed from server`\n      )\n      setTimeout(() => {\n        setErrorMsg(null)\n      }, 5000);\n    })\n\n\n  }\n\n  const handlePut = (person, id) => {\n    console.log('called handleput func')\n\n    personService.putPerson(person, id)\n    .then(response => {\n      const filteredPersons = persons.filter(person => person.id !== id)      \n      const newPerson = response.data\n\n      filteredPersons.push(newPerson)\n      \n      setPersons(filteredPersons)\n    \n    })\n  }\n  \n  const doesPersonExist = () => {\n    const fakeNewPerson = createPersonObject()\n\n    const currentPersons = [...persons].filter(person => person.name === fakeNewPerson.name)\n\n    if (currentPersons.length > 0) {\n      return currentPersons[0]\n    }\n   \n\n    return false;\n  }\n\n\n  return (\n    <div>\n\n      <SuccessNotification message={successMsg} />\n      <ErrorNotification message={errorMsg} />\n\n      <h2>Phonebook</h2>\n\n      <Filter inputValue={filter} onInputChange={filterBy} />\n \n      <h2>add a new</h2>\n      <form onSubmit={addNewPerson}>\n        <div>\n          name: <input value={newName} onChange={handleInputChange} />\n        </div>\n\n        <div>number: <input value={newNumber} onChange={handleNumberChenge} /></div>\n\n        <div>\n          <button type=\"submit\">add</button>\n        </div>\n\n      </form>\n      <h2>Numbers</h2>\n      \n      {personsToShow.map(person => <Contact key={person.name} removeFunction={handleRemove} person={person} />)}\n\n    </div>\n  )\n\n}\n\nexport default App"],"mappings":"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"},"metadata":{},"sourceType":"module"}